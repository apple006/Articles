## 运行时数据区

Java虚拟机在执行Java程序的过程中会把它所管理的内存划分为若干个不同的数据区域，这些区域都有各自的用途、创建和销毁时间。

根据《Java虚拟机规范》的规定，目前Java虚拟记所管理的内存将会包括一下几个运行时数据区域。


- 程序计数器

- Java虚拟机栈

- 本地方法栈

- Java堆

- 方法区

- 运行时常量池

- 直接内存


### 程序计数器（Program Counter Register）

> 首先来了解一程序计数器是什么，这在运行时数据区中是一块较小的内存空间，作用可以看做是当前线程所执行的字节码的行号指示
器。意思就是说，一个Java程序通过字节码解释器进行执行，需要通过行号指示器的值来选取下一条需要执行的字节码指令的，遇到
分支、循环、跳转、异常处理、线程恢复等等基础的功能都需要这个计数器来完成。

> 由于Java多线程是通过线程轮换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，单个处理器同一时间只会处理单个线
程的指令，执行完当前线程的指令后需要恢复到正确的执行位置，那么每个线程就需要有一个独立的程序计数器，各个线程之前的计数器
互不影响，独立存储，为每个线程的私有内存，所以这类内存区域也叫“线程私有”内存。


- 如果线程正在执行的是一个Java方法，那么计数器记录的是正在执行的虚拟机字节码指令的地址。
- 如果正在执行的是Native方法，那么计数器为空。


### Java虚拟机栈（Java Virtual Machine Stacks）

首先Java虚拟机栈和程序计数器一样，也是线程私有的内存空间，生命周期和线程相同，虚拟机栈描述是Java方法执行的内存模型。
每个方法在被执行的时候，就会在Java虚拟机栈中创建一个栈帧，这个栈帧是一种数据结构，是虚拟机栈区域的组成元素，每一个方法
的调用到结束都是栈帧从入栈到出栈的过程。

在概念模型上，栈帧的主要是由：

- 局部变量表（Local Stack Frame）

- 操作数栈（Operand Stack）

- 动态链接（Dynamic linking） 

- 返回地址（Return Address）

这四个部分组成。

如图所示：

![Java虚拟机栈](./img/虚拟机栈.jpg)

栈也其实代表局部变量表这一部分。

#### 局部变量表

局部变量表存放着编译期间已知的各种数据类型，如存放方法参数和局部变量，在Class 文件的方法表的 Code 属性
的 max_locals 指定了该方法所需局部变量表的最大容量。

基本数据类型有:
- boolean
- byte
- char
- short
- int
- float
- long
- double

对象引用类型有:
- reference类型（可能是指向对象起始地址的引用指针，也可能是指向一个代表对象的句柄或者其他此对象相关的位置）
- returnAddress类型（指向一条字节码指令的地址）


 